datamodelMO_A=datamodeltemp[apply(datamodeltemp[,-c(1,2)], 1,min)<3,]
View(datamodelMO_A)
tile_history_const=melt(tile_history_const,id.vars = c("Departamento","prov2"),factorsAsStrings = F)
library(DescTools)
histIndex=grep("feb|mar|abr",names(datamodel))
tile_history=datamodel[,c(1:2,histIndex)]
tile_history_const=tile_history[apply(tile_history[,-c(1,2)],1,function(x){length(unique(x))})==1,]
datamodeltemp=tile_history[apply(tile_history[,-c(1,2)],1,function(x){length(unique(x))})>1,]
datamodeltemp[,-c(1,2)]=lapply(datamodeltemp[,-c(1,2)],as.numeric)
datamodelMA_EX=datamodeltemp[apply(datamodeltemp[,-c(1,2)], 1,min)>=3,]
datamodelMO_A=datamodeltemp[apply(datamodeltemp[,-c(1,2)], 1,min)<3,]
tile_history_const=melt(tile_history_const,id.vars = c("Departamento","prov2"),factorsAsStrings = F)
datamodelMA_EX=melt(datamodelMA_EX,id.vars = c("Departamento","prov2"),factorsAsStrings = F)
datamodelMO_A=melt(datamodelMO_A,id.vars = c("Departamento","prov2"),factorsAsStrings = F)
baseTileHisto_c=ggplot(data=tile_history_const,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileHisto_c=baseTileHisto_c+geom_tile()
TileHisto_c=TileHisto_c+ scale_fill_manual(values=color1,drop=F)
TileHisto_c=TileHisto_c+theme(axis.text.y = element_text(size = 5))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_c + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_maex=ggplot(data=datamodelMA_EX,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_maex=baseTileHisto_maex+geom_tile()
TileHisto_maex=TileHisto_maex+ scale_fill_manual(values=color1,drop=F)
TileHisto_maex=TileHisto_maex+theme(axis.text.y = element_text(size = 4))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_maex + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
View(datamodelMA_EX)
datamodeltemp=tile_history[apply(tile_history[,-c(1,2)],1,function(x){length(unique(x))})>1,]
datamodeltemp[,-c(1,2)]=lapply(datamodeltemp[,-c(1,2)],as.numeric)
datamodelMA_EX=datamodeltemp[apply(datamodeltemp[,-c(1,2)], 1,min)>=3,]
datamodelMO_A=datamodeltemp[apply(datamodeltemp[,-c(1,2)], 1,min)<3,]
View(tile_history)
datamodelMA_EX=tile_history[tile_history$prov2%in%datamodelMA_EX$prov2,]
View(datamodelMA_EX)
datamodelMO_A=tile_history[tile_history$prov2%in%datamodelMO_A$prov2,]
View(datamodelMO_A)
library(DescTools)
histIndex=grep("feb|mar|abr",names(datamodel))
tile_history=datamodel[,c(1:2,histIndex)]
tile_history_const=tile_history[apply(tile_history[,-c(1,2)],1,function(x){length(unique(x))})==1,]
datamodeltemp=tile_history[apply(tile_history[,-c(1,2)],1,function(x){length(unique(x))})>1,]
datamodeltemp[,-c(1,2)]=lapply(datamodeltemp[,-c(1,2)],as.numeric)
datamodelMA_EX=datamodeltemp[apply(datamodeltemp[,-c(1,2)], 1,min)>=3,]
datamodelMO_A=datamodeltemp[apply(datamodeltemp[,-c(1,2)], 1,min)<3,]
datamodelMA_EX=tile_history[tile_history$prov2%in%datamodelMA_EX$prov2,]
datamodelMO_A=tile_history[tile_history$prov2%in%datamodelMO_A$prov2,]
tile_history_const=melt(tile_history_const,id.vars = c("Departamento","prov2"),factorsAsStrings = F)
datamodelMA_EX=melt(datamodelMA_EX,id.vars = c("Departamento","prov2"),factorsAsStrings = F)
datamodelMO_A=melt(datamodelMO_A,id.vars = c("Departamento","prov2"),factorsAsStrings = F)
baseTileHisto_c=ggplot(data=tile_history_const,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileHisto_c=baseTileHisto_c+geom_tile()
TileHisto_c=TileHisto_c+ scale_fill_manual(values=color1,drop=F)
TileHisto_c=TileHisto_c+theme(axis.text.y = element_text(size = 5))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_c + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_maex=ggplot(data=datamodelMA_EX,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_maex=baseTileHisto_maex+geom_tile()
TileHisto_maex=TileHisto_maex+ scale_fill_manual(values=color1,drop=F)
TileHisto_maex=TileHisto_maex+theme(axis.text.y = element_text(size = 4))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_maex + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_maex=ggplot(data=datamodelMA_EX,
aes(x=variable,
y=reorder(prov2,value),
fill=value)) +theme_ipsum()
TileHisto_maex=baseTileHisto_maex+geom_tile()
TileHisto_maex=TileHisto_maex+ scale_fill_manual(values=color1,drop=F)
TileHisto_maex=TileHisto_maex+theme(axis.text.y = element_text(size = 4))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_maex + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_maex=ggplot(data=datamodelMA_EX,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_maex=baseTileHisto_maex+geom_tile()
TileHisto_maex=TileHisto_maex+ scale_fill_manual(values=color1,drop=F)
TileHisto_maex=TileHisto_maex+theme(axis.text.y = element_text(size = 4))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_maex + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_moa=ggplot(data=datamodelMO_A,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_moa=baseTileHisto_moa+geom_tile()
TileHisto_moa=TileHisto_moa+ scale_fill_manual(values=color1,drop=F)
TileHisto_moa=TileHisto_moa+theme(axis.text.y = element_text(size = 4))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_moa + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileUp=ggplot(data=tile_change_up,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileUp=baseTileUp+geom_tile()
TileUp=TileUp+ scale_fill_manual(values=color1,drop=F)
TileUp=TileUp+theme(axis.text.y = element_text(size = 5,face='bold'))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileUp + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileDown=ggplot(data=tile_change_down,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileDown=baseTileDown+geom_tile()
TileDown=TileDown+ scale_fill_manual(values=color1,drop=F)
TileDown=TileDown+theme(axis.text.y = element_text(size = 7,face='bold'))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileDown + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileDown=ggplot(data=tile_change_down,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileDown=baseTileDown+geom_tile()
TileDown=TileDown+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileDown=TileDown+theme(axis.text.y = element_text(size = 7,face='bold'))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileDown + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_c=ggplot(data=tile_history_const,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileHisto_c=baseTileHisto_c+geom_tile()
TileHisto_c=TileHisto_c+ scale_fill_manual(values=color1,drop=F)
TileHisto_c=TileHisto_c+theme(axis.text.y = element_text(size = 4))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_c + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_c=ggplot(data=tile_history_const,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileHisto_c=baseTileHisto_c+geom_tile()
TileHisto_c=TileHisto_c+ scale_fill_manual(values=color1,drop=F)
TileHisto_c=TileHisto_c+theme(axis.text.y = element_text(size = 5),axis.text.x = element_text(size = 5))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_c + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_c=ggplot(data=tile_history_const,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileHisto_c=baseTileHisto_c+geom_tile()
TileHisto_c=TileHisto_c+ scale_fill_manual(values=color1,drop=F)
TileHisto_c=TileHisto_c+theme(axis.text.y = element_text(size = 5,face='bold'),axis.text.x = element_text(size = 10,face='bold'))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_c + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_c=ggplot(data=tile_history_const,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileHisto_c=baseTileHisto_c+geom_tile()
TileHisto_c=TileHisto_c+ scale_fill_manual(values=color1,drop=F)
TileHisto_c=TileHisto_c+theme(axis.text.y = element_text(size = 5,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_c + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_c=ggplot(data=tile_history_const,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileHisto_c=baseTileHisto_c+geom_tile()
TileHisto_c=TileHisto_c+ scale_fill_manual(values=color1,drop=F)
TileHisto_c=TileHisto_c+theme(axis.text.y = element_text(size = 5,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 0))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_c + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_c=ggplot(data=tile_history_const,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileHisto_c=baseTileHisto_c+geom_tile()
TileHisto_c=TileHisto_c+ scale_fill_manual(values=color1,drop=F)
TileHisto_c=TileHisto_c+theme(axis.text.y = element_text(size = 5,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_c + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_moa=ggplot(data=datamodelMO_A,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_moa=baseTileHisto_moa+geom_tile()
TileHisto_moa=TileHisto_moa+ scale_fill_manual(values=color1,drop=F)
TileHisto_moa=TileHisto_moa+theme(axis.text.y = element_text(size = 4))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_moa + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_moa=ggplot(data=datamodelMO_A,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_moa=baseTileHisto_moa+geom_tile()
TileHisto_moa=TileHisto_moa+ scale_fill_manual(values=color1,drop=F)
TileHisto_moa=TileHisto_moa+theme(axis.text.y = element_text(size = 5,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_moa + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_moa=ggplot(data=datamodelMO_A,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_moa=baseTileHisto_moa+geom_tile()
TileHisto_moa=TileHisto_moa+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileHisto_moa=TileHisto_moa+theme(axis.text.y = element_text(size = 5,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_moa + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_moa=ggplot(data=datamodelMO_A,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_moa=baseTileHisto_moa+geom_tile()
TileHisto_moa=TileHisto_moa+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileHisto_moa=TileHisto_moa+theme(axis.text.y = element_text(size = 4,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_moa + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_moa=ggplot(data=datamodelMO_A,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_moa=baseTileHisto_moa+geom_tile()
TileHisto_moa=TileHisto_moa+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileHisto_moa=TileHisto_moa+theme(axis.text.y = element_text(size = 4,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_moa + labs(x="Semana",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_maex=ggplot(data=datamodelMA_EX,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_maex=baseTileHisto_maex+geom_tile()
TileHisto_maex=TileHisto_maex+ scale_fill_manual(values=color1,drop=F)
TileHisto_maex=TileHisto_maex+theme(axis.text.y = element_text(size = 4))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_maex + labs(x="Semana",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_maex=ggplot(data=datamodelMA_EX,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_maex=baseTileHisto_maex+geom_tile()
TileHisto_maex=TileHisto_maex+ scale_fill_manual(values=color1,drop=F)
TileHisto_maex=TileHisto_maex+theme(axis.text.y = element_text(size = 4))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
#panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_maex + labs(x="Semana",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_maex=ggplot(data=datamodelMA_EX,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_maex=baseTileHisto_maex+geom_tile()
TileHisto_maex=TileHisto_maex+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileHisto_maex=TileHisto_maex+theme(axis.text.y = element_text(size = 4))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_maex + labs(x="Semana",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_maex=ggplot(data=datamodelMA_EX,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_maex=baseTileHisto_maex+geom_tile()
TileHisto_maex=TileHisto_maex+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileHisto_maex=TileHisto_maex+theme(axis.text.y = element_text(size = 5,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_maex + labs(x="Semana",y="") + scale_x_discrete(expand = c(0, 0))
baseTileUp=ggplot(data=tile_change_up,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileUp=baseTileUp+geom_tile()
TileUp=TileUp+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileUp=TileUp+theme(axis.text.y = element_text(size = 5,face='bold'))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileUp + labs(x="",y="") + scale_x_discrete(expand = c(0, 0))
baseTileHisto_moa=ggplot(data=datamodelMO_A,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_moa=baseTileHisto_moa+geom_tile()
TileHisto_moa=TileHisto_moa+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileHisto_moa=TileHisto_moa+theme(axis.text.y = element_text(size = 4,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_moa +  labs(x="",y="", title = "Niveles Asignados desde quincena de Febrero 2021", subtitle = "Provincias que permanecieron en diversos niveles")  + scale_x_discrete(expand = c(0, 0))
baseTileHisto_moa=ggplot(data=datamodelMO_A,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_moa=baseTileHisto_moa+geom_tile()
TileHisto_moa=TileHisto_moa+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileHisto_moa=TileHisto_moa+theme(axis.text.y = element_text(size = 4,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_moa +  labs(x="",y="", title = "Niveles Asignados desde quincena de Febrero 2021", subtitle = "Provincias que permanecieron en diversos niveles")  + scale_x_discrete(expand = c(0, 0))
baseTileHisto_moa=ggplot(data=datamodelMO_A,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_moa=baseTileHisto_moa+geom_tile()
TileHisto_moa=TileHisto_moa+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileHisto_moa=TileHisto_moa+theme(axis.text.y = element_text(size = 4,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_moa +  labs(x="",y="", title = "Niveles Asignados desde quincena de Febrero 2021", subtitle = "Provincias que permanecieron en diversos niveles")  + scale_x_discrete(expand = c(0, 0))
baseTileHisto_moa=ggplot(data=datamodelMO_A,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_moa=baseTileHisto_moa+geom_tile()
TileHisto_moa=TileHisto_moa+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileHisto_moa=TileHisto_moa+theme(axis.text.y = element_text(size = 8,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_moa +  labs(x="",y="", title = "Niveles Asignados desde quincena de Febrero 2021", subtitle = "Provincias que permanecieron en diversos niveles")  + scale_x_discrete(expand = c(0, 0))
num=length(unique(datamodelMO_A$variable))
num
num=length(unique(datamodelMO_A$variable))
baseTileHisto_moa=ggplot(data=datamodelMO_A,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_moa=baseTileHisto_moa+geom_tile()
TileHisto_moa=TileHisto_moa+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileHisto_moa=TileHisto_moa+theme(axis.text.y = element_text(size = 4,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_moa +  labs(x="",y="", title = "Niveles Asignados desde quincena de Febrero 2021", subtitle = "Provincias que permanecieron en diversos niveles")  + scale_x_discrete(expand = c(0, 0))
num=length(unique(datamodelMO_A$prov2))
baseTileHisto_moa=ggplot(data=datamodelMO_A,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_moa=baseTileHisto_moa+geom_tile()
TileHisto_moa=TileHisto_moa+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileHisto_moa=TileHisto_moa+theme(axis.text.y = element_text(size = 4,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_moa +  labs(x="",y="", title = "Niveles Asignados desde quincena de Febrero 2021", subtitle = paste("Provincias que permanecieron en diversos niveles:",num)  + scale_x_discrete(expand = c(0, 0))
num=length(unique(datamodelMO_A$prov2))
baseTileHisto_moa=ggplot(data=datamodelMO_A,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_moa=baseTileHisto_moa+geom_tile()
TileHisto_moa=TileHisto_moa+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileHisto_moa=TileHisto_moa+theme(axis.text.y = element_text(size = 4,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_moa +  labs(x="",y="", title = "Niveles Asignados desde quincena de Febrero 2021", subtitle = paste("Provincias que permanecieron en diversos niveles:",num))  + scale_x_discrete(expand = c(0, 0))
num=length(unique(datamodelMA_EX$prov2))
baseTileHisto_maex=ggplot(data=datamodelMA_EX,
aes(x=variable,
y=reorder(prov2,value,FUN=min),
fill=value)) +theme_ipsum()
TileHisto_maex=baseTileHisto_maex+geom_tile()
TileHisto_maex=TileHisto_maex+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileHisto_maex=TileHisto_maex+theme(axis.text.y = element_text(size = 5,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_maex +  labs(x="",y="", title = "Niveles Asignados desde quincena de Febrero 2021", subtitle = paste("Provincias que permanecieron en los niveles MUY ALTO y EXTREMO:",num))  + scale_x_discrete(expand = c(0, 0))
baseTileHisto_c=ggplot(data=tile_history_const,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileHisto_c=baseTileHisto_c+geom_tile()
TileHisto_c=TileHisto_c+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileHisto_c=TileHisto_c+theme(axis.text.y = element_text(size = 5,face='bold'),axis.text.x = element_text(size = 10,face='bold',angle = 60, hjust = 1))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileHisto_c + labs(x="",y="", title = "Niveles Asignados desde quincena de Febrero 2021", subtitle = "Provincias que permanecieron en su nivel") + scale_x_discrete(expand = c(0, 0))
baseTileDown=ggplot(data=tile_change_down,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileDown=baseTileDown+geom_tile()
TileDown=TileDown+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileDown=TileDown+theme(axis.text.y = element_text(size = 7,face='bold'))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileDown + labs(x="",y="", title = "Provincia que bajan de nivel", subtitle = "Modelo Corregido") + scale_x_discrete(expand = c(0, 0))
num=length(unique(tile_change_down$prov2))
num=length(unique(tile_change_down$prov2))
baseTileDown=ggplot(data=tile_change_down,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileDown=baseTileDown+geom_tile()
TileDown=TileDown+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileDown=TileDown+theme(axis.text.y = element_text(size = 7,face='bold'))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileDown + labs(x="",y="", title = paste("Provincia que bajan de nivel (",num,")") subtitle = "Modelo Corregido") + scale_x_discrete(expand = c(0, 0))
num=length(unique(tile_change_down$prov2))
baseTileDown=ggplot(data=tile_change_down,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileDown=baseTileDown+geom_tile()
TileDown=TileDown+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileDown=TileDown+theme(axis.text.y = element_text(size = 7,face='bold'))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileDown + labs(x="",y="", title = paste("Provincia que bajan de nivel (",num,")"), subtitle = "Modelo Corregido") + scale_x_discrete(expand = c(0, 0))
num=length(unique(tile_change_up$prov2))
baseTileUp=ggplot(data=tile_change_up,
aes(x=variable,
y=reorder(prov2,value,min),
fill=value)) +theme_ipsum()
TileUp=baseTileUp+geom_tile()
TileUp=TileUp+ scale_fill_manual(values=color1,drop=F,name="Nivel")
TileUp=TileUp+theme(axis.text.y = element_text(size = 5,face='bold'))+ theme(panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE,
panel.background = element_blank(),
legend.key = element_rect(colour = "black"))
TileUp + labs(x="",y="", title = paste("Provincia que suben de nivel (",num,")") , subtitle = "Modelo Corregido") + scale_x_discrete(expand = c(0, 0))
