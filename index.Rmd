---
title: "Minsa-medidas"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(ggplot2)
library(plotly)



cdc=readRDS("falles_casos.RDS")
cdcPos=aggregate(data=cdc,pos~semana,sum)
cdcFalle=aggregate(data=cdc,falles_cov~semana,sum)
cdcPosFalle=merge(cdcPos,cdcFalle)
cdcPosFalle=cdcPosFalle[cdcPosFalle$semana>=202008 & cdcPosFalle$semana<=202113,]
cdcPosFalle$semana=as.ordered(cdcPosFalle$semana)
base=ggplot(data=cdcPosFalle) + theme_minimal() + theme(axis.title.y = element_blank()) +xlab("Año-Semana")

library(ggpmisc)


```





Column {data-width=350}
-----------------------------------------------------------------------

### Casos Confirmados

```{r, echo=FALSE}

casos=base+geom_line(aes(x=semana,
                        y=pos,group=1),color='pink')
casos=casos+stat_peaks(aes(x=semana,
                        y=pos,group=1),span=3,colour = "red")
casos1=casos+theme(axis.text.x = element_text(angle = 80,size = 4,vjust = 0.5,hjust = 0.5))

ggplotly(casos1,tooltip = c("semana","pos"))
```

### Fallecidos Covid

```{r}

falles=base+geom_line(aes(x=semana,
                        y=falles_cov,group=1), color="grey80")

falles=falles+stat_peaks(aes(x=semana,
                        y=falles_cov,group=1),span=3,colour = "black")
falles1=falles+theme(axis.text.x = element_text(angle = 80,size = 4,vjust = 0.5,hjust = 0.5))

ggplotly(falles1,tooltip = c("semana","falles_cov"))
```




Column {data-width=650}
-----------------------------------------------------------------------

### Comparación Casos versus Fallecidos
```{r}
both=base+geom_line(aes(x=semana,
                        y=falles_cov,group=1),
                    color='grey80')
both=both+stat_peaks(aes(x=semana,
                        y=falles_cov,group=1),
                     span=3,colour = "black")
both=both+geom_line(aes(x=semana,
                        y=pos,group=1),color='pink')
both=both+stat_peaks(aes(x=semana,
                        y=pos,group=1),
                     span=3,colour = "red")

both=both+theme(axis.text.x = element_text(angle = 80,
                                           size = 6,
                                           vjust = 0.5,
                                           hjust = 0.5))
both=both + scale_y_log10()

ggplotly(both,tooltip = c("semana","pos","falles_cov"))

```


